<div class="header header-{{theme}}">
  <a href="https://palmyrastudio.vermeg.com/hzerai-466017-app/" class="mx-auto">
    <div class="advisor">
      <img src="assets\img\palmyraLogo.png" alt="logo" class="logo">
    </div>
  </a>
  <div class="me-2">
    <p class="text-white fw-bold m-auto mb-1">Theme</p>
    <div (click)="changeTheme()" [ngClass]="theme == 'dark' ? 'bg-primary' : 'bg-dark'"
      style="width: 30px; height: 30px; border-radius: 50%; margin: auto auto; cursor: pointer;">
    </div>
  </div>
</div>
<div *ngIf="correlationIdEnabled && db && db.length > 0 && !log && !this.uploading"
  class="d-flex justify-content-center align-items-center bg-{{theme}} text-white"
  (click)="correlationView = !correlationView;"
  style="position: absolute; left: 30px; top: 200px;width: 100px; height: 100px; border-radius: 50%; cursor: pointer;">
  <p class="fw-bold mt-1">{{correlationView ? 'Analysis' : 'Correlations'}}</p>
</div>
<div class="container container-fluid" style="margin-bottom: 6rem; margin-top: 1rem;">
  <div>
    <main>
      <div *ngIf="!this.db && !this.uploading">
        <div class="jumbotron">
          <h1 class="display-4">Hello, there!</h1>
          <p class="lead">This is a simple proof of concept for Advisor.</p>
          <hr class="my-4">
          <p>Our aim is to collect more user requirements.</p>
        </div>
        <div class="w-100 d-flex flex-column justify-content-center align-items-center ">
          <div class="rounded shadow-lg body-bg p-5 w-75">
            <tabset [justified]="true">
              <tab (selectTab)="stacktrace = false" heading="Upload files">
                <div class="input-group pt-2">
                  <input (change)="fileChange($event)" type="file" class="form-control" id="inputGroupFile04"
                    aria-describedby="inputGroupFileAddon04" aria-label="Upload" multiple>
                  <button (click)="analyseFile()" class="btn btn-outline-{{theme}} w-25 fs-6" type="button"
                    [disabled]="!file && !files && !jiraId">
                    Analyse
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                      class="bi bi-cloud-arrow-up ms-2 my-0" viewBox="0 0 19 19">
                      <path fill-rule="evenodd"
                        d="M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708l2-2z" />
                      <path
                        d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383zm.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z" />
                    </svg>
                  </button>
                </div>

              </tab>
              <tab (selectTab)="stacktrace = false" heading="Analyse jira ticket">
                <div class="input-group pt-2">
                  <input [(ngModel)]="jiraId" type="text" class="form-control"
                    placeholder="Jira Key (example : HHH-5035)" aria-describedby="Jira Key">
                  <button (click)="analyseFile()" class="btn btn-outline-{{theme}} w-25 fs-6" type="button"
                    [disabled]="!file && !files && !jiraId"> Analyse
                    <img src="assets\img\jira.png" class="my-0" alt="jira logo" width="30px" height="20px">
                  </button>
                </div>

              </tab>
              <tab (selectTab)="stacktrace = true" heading="Stacktrace">
                <div class="input-group pt-2">
                  <textarea [(ngModel)]="stacktracetext" class="form-control"
                    placeholder="Paste your stacktrace here..." aria-describedby="stacktrace holder"></textarea>
                  <button (click)="analyseStacktrace()" class="btn btn-outline-{{theme}} w-100 fs-6 mt-3" type="button"
                    [disabled]="!stacktracetext"> Analyse stacktrace
                  </button>
                </div>
              </tab>
            </tabset>
            <div *ngIf="!stacktrace" style="margin-top: 3vh;">

              <span class="badge bg-secondary mb-1">Limit your search </span>
              <div class="input-group">
                <input type="text" placeholder="From Date" class="form-control" [(ngModel)]="fromDate"
                  [bsConfig]="{rangeInputFormat : 'MM/DD/YYYY', dateInputFormat: 'MM/DD/YYYY'}" bsDatepicker>
                <timepicker style="margin-left: 2rem;" *ngIf="fromDate" [(ngModel)]="fromTime" [showMinutes]="true"
                  [showSeconds]="true" [showSpinners]="false">
                </timepicker>
              </div>
              <div class="input-group mt-1">
                <input type="text" placeholder="To Date" class="form-control" [(ngModel)]="toDate"
                  [bsConfig]="{rangeInputFormat : 'MM/DD/YYYY', dateInputFormat: 'MM/DD/YYYY'}" bsDatepicker>
                <timepicker style="margin-left: 2rem;" *ngIf="toDate" [(ngModel)]="toTime" [showMinutes]="true"
                  [showSeconds]="true" [showSpinners]="false">
                </timepicker>
              </div>
              <div class="mt-1">
                <div class="input-group">
                  <input [(ngModel)]="exceptionNameFilter" type="text" class="form-control" placeholder="Matches">
                </div>
              </div>

              <span class="badge bg-secondary mb-1 mt-3">Enhance your search </span>
              <div class="form-check">
                <input [(ngModel)]="correlationIdEnabled" class="form-check-input" type="checkbox" value=""
                  id="correlationId">
                <label class="form-check-label" for="correlationId">
                  Enable correlation id search
                </label>
              </div>
            </div>

          </div>
        </div>
        <div *ngIf="savedReports" class="raw" style="margin-top: 10rem;">
          <div class="container">
            <h4>Recent analysis</h4>
          </div>
          <div class="list-group">
            <a *ngFor="let savedReport of savedReports" (click)="loadSavedReport(savedReport)" href="#"
              class="list-group-item list-group-item-action">
              <div class="d-flex justify-content-between p-0">
                <p class="text-truncate m-0">{{savedReport.fileName}}</p>
                <span
                  class="badge bg-{{theme}} position-relative p-auto d-flex align-items-center justify-content-center">
                  <p class="my-1"> {{savedReport.date|date:'yyyy-MM-dd HH:mm:ss'}} </p>
                  <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    {{savedReport.data.length}}
                    <span class="visually-hidden">exceptions found</span>
                  </span>
                </span>
              </div>
            </a>
          </div>
        </div>
      </div>
      <div class="container mt-5" *ngIf="this.uploading" style="width: 50vw;">
        <div *ngIf="!this.log" class="card text-white w-100"
          [ngClass]="this.db.length > 0 ? 'border-danger' : 'border-success'">
          <div class="card-header text-black">Advisor</div>
          <div class="card-body d-flex justify-content-between">
            <div>
              <h5 class="card-title" [ngClass]="this.db.length > 0 ? 'text-danger' : 'text-success'">Result is ready
              </h5>
              <p class="card-text" [ngClass]="this.db.length > 0 ? 'text-danger' : 'text-success'">
                {{this.db.length > 0 ?
                (this.db.length > 1 ? 'Multiple exceptions founds' :'One exception found')
                : 'Great you don\'t have any exceptions'}}
              </p>
            </div>
            <div class="w-25 h-75">
              <button *ngIf="this.db.length >0" class="btn btn-danger w-100 h-100 fw-bold" type="button"
                (click)="log = null; folderFiles = null; uploading = null">Show result</button>
              <a *ngIf="this.db.length ==0" class="btn btn-success w-100 h-100 fw-bold"
                href="https://palmyrastudio.vermeg.com/hzerai-466017-app/" type="button">cancel</a>
            </div>
          </div>
        </div>
        <div *ngIf="filesStartSize>0" class="w-100 d-flex justify-content-center align-items-center mt-5">
          <progressbar class="progress-striped active" [value]="100-(fileNb*100)/filesStartSize"
            [type]="db.length == 0 ? 'success' : (db.length < 5 ? 'warning' : 'danger')">
            <i>{{(100-(fileNb*100)/filesStartSize | number: '.0-0' )+ '%'}}</i>
          </progressbar>
        </div>
        <div *ngIf="this.log && fileNb==0" class="w-100 d-flex justify-content-center align-items-center ">
          <div class="spinner-grow text-{{theme}}" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="spinner-grow text-secondary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="spinner-grow text-success" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="spinner-grow text-danger" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="spinner-grow text-warning" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="spinner-grow text-info" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="spinner-grow text-success" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="spinner-grow text-dark" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
        <div class="p-5" style="font-size: 15px;">
          <ul *ngIf="folderFiles" class="list-group">
            <li *ngFor="let item of folderFiles" class="list-group-item py-1 px-2">
              <div class="d-flex justify-content-between align-items-center text-truncate">
                {{item.fileName}}
                <span *ngIf="item.count != null" class="badge badge-pill"
                  [ngClass]="item.count > 0 ? 'bg-danger' : 'bg-success'"> found {{item.count}} exceptions in
                  {{item.time}} seconds</span>
                <div *ngIf="item.count == null" class="w-25">
                  <div class="progress">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"
                      aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%"></div>
                  </div>
                </div>
              </div>
            </li>
          </ul>
        </div>

        <div></div>
      </div>
      <div class="" *ngIf="db && db.length == 0 && !log && !this.uploading">
        <div class="row">
          <div class="col-md-12">
            <div class="error-template">
              <h1> Oops!</h1>
              <div *ngIf="error"> <span class="badge bg-danger">{{error}}</span> </div>
              <h2 *ngIf="!error"> This log seems to be from a different era</h2>
              <div class="error-details">
                We would like to help you next time, it would be great if you shared this file with us. Thanks!
              </div>
              <div class="error-actions">
                <a href="" class="btn btn-{{theme}} btn-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor"
                    class="bi bi-house-door-fill" viewBox="0 0 19 19">
                    <path
                      d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5z" />
                  </svg>
                  Take Me Home </a>
                <a href="" class="btn btn-secondary btn-lg">
                  <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="currentColor"
                    class="bi bi-envelope" viewBox="0 0 19 19">
                    <path
                      d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z" />
                  </svg>
                  Contact Support </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="db && db.length > 0 && !log && !this.uploading && !correlationView">
        <div class="row d-flex flex-md-nowrap mt-3">
          <div class="input-group d-flex">
            <a class="text-{{theme}}" (click)="initFilter(); showFilter = !showFilter" data-bs-toggle="collapse"
              href="#filter" role="button" aria-expanded="false" aria-controls="filter">
              <span class="input-group-text" id="basic-addon1" class="text-{{theme}}">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                  <path fill-rule="evenodd"
                    d="M7.72.22a.75.75 0 011.06 0l1.204 1.203A4.983 4.983 0 0112 1c.717 0 1.4.151 2.016.423L15.22.22a.75.75 0 011.06 1.06l-.971.972A4.988 4.988 0 0117 6v1.104a2.755 2.755 0 011.917 1.974l1.998-.999a.75.75 0 01.67 1.342L19 10.714V13.5l3.25.003a.75.75 0 110 1.5L19 15.001V16a7.02 7.02 0 01-.204 1.686.833.833 0 01.04.018l2.75 1.375a.75.75 0 11-.671 1.342l-2.638-1.319A7 7 0 0112 23a7 7 0 01-6.197-3.742l-2.758 1.181a.75.75 0 11-.59-1.378l2.795-1.199A7.007 7.007 0 015 16v-.996H1.75a.75.75 0 010-1.5H5v-2.79L2.415 9.42a.75.75 0 01.67-1.342l1.998.999A2.755 2.755 0 017 7.104V6a4.99 4.99 0 011.69-3.748l-.97-.972a.75.75 0 010-1.06zM8.5 7h7V6a3.5 3.5 0 10-7 0v1zm-2 3.266V9.75c0-.69.56-1.25 1.25-1.25h8.5c.69 0 1.25.56 1.25 1.25V16a5.5 5.5 0 01-11 0v-5.734z">
                  </path>
                </svg>
              </span>
            </a>
            <div class="flex-grow-1">
              <input type="text" class="form-control"
                placeholder="Search everything or click the debug button for advanced search" aria-label="Search"
                [(ngModel)]="search" (keyup)="updateList() " aria-describedby="basic-addon1" [disabled]="downloading">
            </div>
            <div class="dropend">
              <button class="btn btn-{{theme}} pulse" id="dropdownMenu2" data-bs-toggle="dropdown" aria-expanded="false"
                type="button" [disabled]="downloading">
                <span *ngIf="downloading" class="spinner-border spinner-border-sm" role="status"
                  aria-hidden="true"></span>
                <span [ngClass]="downloading ? 'small' : ''">{{downloading ? ' Downloading ' + downloading +' file...' :
                  (search ? 'Export current search' :'Export analysis')}}</span>
                <svg class="ms-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 114.31 122.88" fill="currentColor"
                  width="24" height="24">
                  <path fill="currentColor"
                    d="M69.88,71.65h35.78a8.68,8.68,0,0,1,8.65,8.66v33.92a8.67,8.67,0,0,1-8.65,8.65H69.88a8.67,8.67,0,0,1-8.65-8.65V80.31a8.68,8.68,0,0,1,8.65-8.66ZM26.26,78.12a3.35,3.35,0,0,1-3.17-3.46,3.29,3.29,0,0,1,3.17-3.45H42.9a3.34,3.34,0,0,1,3.17,3.45,3.29,3.29,0,0,1-3.17,3.46Zm75.19-18.46h-7V8.1a1.17,1.17,0,0,0-.33-.82A1.2,1.2,0,0,0,93.34,7H8.06a1.15,1.15,0,0,0-.82.33,1.13,1.13,0,0,0-.33.82v96.35a1.13,1.13,0,0,0,1.15,1.16H45.17v7H8.1A8.16,8.16,0,0,1,0,104.45V8.1A7.93,7.93,0,0,1,2.39,2.39,8,8,0,0,1,8.1,0H93.39A7.92,7.92,0,0,1,99.1,2.39a8,8,0,0,1,2.39,5.71c0,39.79,0-9.25,0,51.56ZM26.22,33.12a3.36,3.36,0,0,1-3.17-3.46,3.3,3.3,0,0,1,3.17-3.46H75.14a3.35,3.35,0,0,1,3.17,3.46,3.3,3.3,0,0,1-3.17,3.46Zm0,22.5a3.36,3.36,0,0,1-3.17-3.46,3.29,3.29,0,0,1,3.17-3.45H75.14a3.34,3.34,0,0,1,3.17,3.45,3.29,3.29,0,0,1-3.17,3.46Zm74,39.25a2.44,2.44,0,0,1,2.08,1c1.1,1.64-.4,3.27-1.43,4.41-3,3.23-9.61,9.08-11.07,10.79a2.39,2.39,0,0,1-3.76,0c-1.51-1.75-8.53-8-11.33-11.1-1-1.09-2.18-2.58-1.16-4.1a2.45,2.45,0,0,1,2.08-1H80.9V85.48a3,3,0,0,1,2.95-3h8.22a3,3,0,0,1,3,3v9.39Z" />
                </svg>

              </button>
              <ul class="dropdown-menu" aria-labelledby="dropdownMenu2"
                style="cursor: pointer; padding: 0; border: transparent; background-color: transparent;">
                <li class="dropdown-item" style="padding: 0;">
                  <svg (click)="downloading = 'pdf'; SavePDF()" class="mx-2" xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 303.188 303.188" width="38"
                    height="38" style="enable-background:new 0 0 303.188 303.188;" xml:space="preserve">
                    <g>
                      <polygon style="fill:#E8E8E8;"
                        points="219.821,0 32.842,0 32.842,303.188 270.346,303.188 270.346,50.525 	" />
                      <path style="fill:#FB3449;"
                        d="M230.013,149.935c-3.643-6.493-16.231-8.533-22.006-9.451c-4.552-0.724-9.199-0.94-13.803-0.936
		c-3.615-0.024-7.177,0.154-10.693,0.354c-1.296,0.087-2.579,0.199-3.861,0.31c-1.314-1.36-2.584-2.765-3.813-4.202
		c-7.82-9.257-14.134-19.755-19.279-30.664c1.366-5.271,2.459-10.772,3.119-16.485c1.205-10.427,1.619-22.31-2.288-32.251
		c-1.349-3.431-4.946-7.608-9.096-5.528c-4.771,2.392-6.113,9.169-6.502,13.973c-0.313,3.883-0.094,7.776,0.558,11.594
		c0.664,3.844,1.733,7.494,2.897,11.139c1.086,3.342,2.283,6.658,3.588,9.943c-0.828,2.586-1.707,5.127-2.63,7.603
		c-2.152,5.643-4.479,11.004-6.717,16.161c-1.18,2.557-2.335,5.06-3.465,7.507c-3.576,7.855-7.458,15.566-11.815,23.02
		c-10.163,3.585-19.283,7.741-26.857,12.625c-4.063,2.625-7.652,5.476-10.641,8.603c-2.822,2.952-5.69,6.783-5.941,11.024
		c-0.141,2.394,0.807,4.717,2.768,6.137c2.697,2.015,6.271,1.881,9.4,1.225c10.25-2.15,18.121-10.961,24.824-18.387
		c4.617-5.115,9.872-11.61,15.369-19.465c0.012-0.018,0.024-0.036,0.037-0.054c9.428-2.923,19.689-5.391,30.579-7.205
		c4.975-0.825,10.082-1.5,15.291-1.974c3.663,3.431,7.621,6.555,11.939,9.164c3.363,2.069,6.94,3.816,10.684,5.119
		c3.786,1.237,7.595,2.247,11.528,2.886c1.986,0.284,4.017,0.413,6.092,0.335c4.631-0.175,11.278-1.951,11.714-7.57
		C231.127,152.765,230.756,151.257,230.013,149.935z M119.144,160.245c-2.169,3.36-4.261,6.382-6.232,9.041
		c-4.827,6.568-10.34,14.369-18.322,17.286c-1.516,0.554-3.512,1.126-5.616,1.002c-1.874-0.11-3.722-0.937-3.637-3.065
		c0.042-1.114,0.587-2.535,1.423-3.931c0.915-1.531,2.048-2.935,3.275-4.226c2.629-2.762,5.953-5.439,9.777-7.918
		c5.865-3.805,12.867-7.23,20.672-10.286C120.035,158.858,119.587,159.564,119.144,160.245z M146.366,75.985
		c-0.602-3.514-0.693-7.077-0.323-10.503c0.184-1.713,0.533-3.385,1.038-4.952c0.428-1.33,1.352-4.576,2.826-4.993
		c2.43-0.688,3.177,4.529,3.452,6.005c1.566,8.396,0.186,17.733-1.693,25.969c-0.299,1.31-0.632,2.599-0.973,3.883
		c-0.582-1.601-1.137-3.207-1.648-4.821C147.945,83.048,146.939,79.482,146.366,75.985z M163.049,142.265
		c-9.13,1.48-17.815,3.419-25.979,5.708c0.983-0.275,5.475-8.788,6.477-10.555c4.721-8.315,8.583-17.042,11.358-26.197
		c4.9,9.691,10.847,18.962,18.153,27.214c0.673,0.749,1.357,1.489,2.053,2.22C171.017,141.096,166.988,141.633,163.049,142.265z
		 M224.793,153.959c-0.334,1.805-4.189,2.837-5.988,3.121c-5.316,0.836-10.94,0.167-16.028-1.542
		c-3.491-1.172-6.858-2.768-10.057-4.688c-3.18-1.921-6.155-4.181-8.936-6.673c3.429-0.206,6.9-0.341,10.388-0.275
		c3.488,0.035,7.003,0.211,10.475,0.664c6.511,0.726,13.807,2.961,18.932,7.186C224.588,152.585,224.91,153.321,224.793,153.959z" />
                      <polygon style="fill:#FB3449;" points="227.64,25.263 32.842,25.263 32.842,0 219.821,0 	" />
                      <g>
                        <path style="fill:#A4A9AD;" d="M126.841,241.152c0,5.361-1.58,9.501-4.742,12.421c-3.162,2.921-7.652,4.381-13.472,4.381h-3.643
			v15.917H92.022v-47.979h16.606c6.06,0,10.611,1.324,13.652,3.971C125.321,232.51,126.841,236.273,126.841,241.152z
			 M104.985,247.387h2.363c1.947,0,3.495-0.546,4.644-1.641c1.149-1.094,1.723-2.604,1.723-4.529c0-3.238-1.794-4.857-5.382-4.857
			h-3.348C104.985,236.36,104.985,247.387,104.985,247.387z" />
                        <path style="fill:#A4A9AD;" d="M175.215,248.864c0,8.007-2.205,14.177-6.613,18.509s-10.606,6.498-18.591,6.498h-15.523v-47.979
			h16.606c7.701,0,13.646,1.969,17.836,5.907C173.119,235.737,175.215,241.426,175.215,248.864z M161.76,249.324
			c0-4.398-0.87-7.657-2.609-9.78c-1.739-2.122-4.381-3.183-7.926-3.183h-3.773v26.877h2.888c3.939,0,6.826-1.143,8.664-3.43
			C160.841,257.523,161.76,254.028,161.76,249.324z" />
                        <path style="fill:#A4A9AD;" d="M196.579,273.871h-12.766v-47.979h28.355v10.403h-15.589v9.156h14.374v10.403h-14.374
			L196.579,273.871L196.579,273.871z" />
                      </g>
                      <polygon style="fill:#D1D3D3;" points="219.821,50.525 270.346,50.525 219.821,0 	" />
                    </g>
                  </svg>
                  <svg (click)="downloading = 'excel'; exportexcel()" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
                    width="42" height="42" viewBox="0 0 48 48" style=" fill:#000000;">
                    <path fill="#169154" d="M29,6H15.744C14.781,6,14,6.781,14,7.744v7.259h15V6z"></path>
                    <path fill="#18482a" d="M14,33.054v7.202C14,41.219,14.781,42,15.743,42H29v-8.946H14z"></path>
                    <path fill="#0c8045" d="M14 15.003H29V24.005000000000003H14z"></path>
                    <path fill="#17472a" d="M14 24.005H29V33.055H14z"></path>
                    <g>
                      <path fill="#29c27f" d="M42.256,6H29v9.003h15V7.744C44,6.781,43.219,6,42.256,6z"></path>
                      <path fill="#27663f" d="M29,33.054V42h13.257C43.219,42,44,41.219,44,40.257v-7.202H29z"></path>
                      <path fill="#19ac65" d="M29 15.003H44V24.005000000000003H29z"></path>
                      <path fill="#129652" d="M29 24.005H44V33.055H29z"></path>
                    </g>
                    <path fill="#0c7238"
                      d="M22.319,34H5.681C4.753,34,4,33.247,4,32.319V15.681C4,14.753,4.753,14,5.681,14h16.638 C23.247,14,24,14.753,24,15.681v16.638C24,33.247,23.247,34,22.319,34z">
                    </path>
                    <path fill="#fff"
                      d="M9.807 19L12.193 19 14.129 22.754 16.175 19 18.404 19 15.333 24 18.474 29 16.123 29 14.013 25.07 11.912 29 9.526 29 12.719 23.982z">
                    </path>
                  </svg>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="collapse mx-3 mt-3" id="filter">
          <div class="rounded p-3 shadow-lg row d-flex flex-wrap">
            <p class="h4">Filter result</p>
            <div class="mb-1 col-4">
              <input id="Exception" class="form-control" name="Exception" [typeaheadMinLength]="0"
                [typeaheadScrollable]="true" placeholder="Exception" [typeaheadOptionsInScrollableView]="5"
                [(ngModel)]="filterObject.name" [typeahead]="filterNames">
            </div>
            <div class="mb-1 col-4">
              <input id="Level" class="form-control" name="Level" [typeaheadMinLength]="0" [typeaheadScrollable]="true"
                placeholder="Level" [typeaheadOptionsInScrollableView]="5" [(ngModel)]="filterObject.level"
                [typeahead]="filterLevels">
            </div>
            <div class="mb-1 col-4">
              <input id="Thread" class="form-control" name="Thread" [typeaheadMinLength]="0"
                [typeaheadScrollable]="true" placeholder="Thread" [typeaheadOptionsInScrollableView]="5"
                [(ngModel)]="filterObject.thread" [typeahead]="filterThreads">
            </div>
            <div class="mb-1 col-4">
              <input id="Logger" class="form-control" name="Logger" [typeaheadMinLength]="0"
                [typeaheadScrollable]="true" placeholder="Logger" [typeaheadOptionsInScrollableView]="5"
                [(ngModel)]="filterObject.logger" [typeahead]="filterLoggers">
            </div>
            <div *ngIf="appName" class="mb-1 col-4">
              <input id="User" class="form-control" name="User" [typeaheadMinLength]="0" [typeaheadScrollable]="true"
                placeholder="User" [typeaheadOptionsInScrollableView]="5" [(ngModel)]="filterObject.user"
                [typeahead]="filterUsers">
            </div>
            <div *ngIf="appName" class="mb-1 col-4">
              <input id="Tenant" class="form-control" name="Tenant" [typeaheadOptionsLimit]="7" [typeaheadMinLength]="0"
                [typeaheadScrollable]="true" placeholder="Tenant" [typeaheadOptionsInScrollableView]="5"
                [(ngModel)]="filterObject.tenant" [typeahead]="filterTenants">
            </div>
            <div class="mb-1 col-4 d-flex flex-nowrap justify-content-center">
              <input type="text" placeholder="from - to" class="form-control" [(ngModel)]="filterObject.dateRange"
                [bsConfig]="{rangeInputFormat : 'MM/DD/YYYY', dateInputFormat: 'MM/DD/YYYY'}" bsDaterangepicker>
            </div>
            <div class="mb-1 col-4" *ngIf="filterObject.dateRange.length > 0">
              <timepicker [(ngModel)]="this.filterObject.fromTime" [showMinutes]="true" [showSeconds]="true"
                [showSpinners]="false"></timepicker>
            </div>
            <div class="mb-1 col-4" *ngIf="filterObject.dateRange.length > 0">
              <timepicker [(ngModel)]="this.filterObject.toTime" [showMinutes]="true" [showSeconds]="true"
                [showSpinners]="false"></timepicker>
            </div>
            <div class="mb-1 col-4">
              <input id="File" class="form-control" name="File" [typeaheadOptionsLimit]="7" [typeaheadMinLength]="0"
                [typeaheadScrollable]="true" placeholder="File" [typeaheadOptionsInScrollableView]="5"
                [(ngModel)]="filterObject.file" [typeahead]="filterFiles">
            </div>
            <div class="col-6 mx-auto d-flex justify-content-center mt-2">
              <button type="submit" (click)="filterUsingObject()" class="btn btn-{{theme}} col-4 mx-1">Search</button>
              <button type="submit" (click)="restUsingObject()" class="btn btn-outline-secondary col-2">Reset</button>
            </div>

          </div>
        </div>
        <div *ngIf="appName" class="row mt-3">
          <div class="alert alert-{{theme}} alert-dismissible fade show" role="alert">
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>

            <div class="d-flex justify-content-between align-items-center">
              <div class="d-flex justify-content-start align-items-center">
                <span class="mx-3"> Application name :</span>
                <h2 class="alert-heading"><b>{{appName}}</b></h2>
              </div>
              <img src="assets\img\palmyraLogo.png" alt="advisor logo" style="max-height: 7vh">
            </div>
            <hr>
            <div class="d-flex">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2" viewBox="0 0 16 16" role="img"
                aria-label="Warning:">
                <path
                  d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
              </svg>
              <p class="mb-0"> This log seems to belong to a <b>Palmyra application!</b> Logs written by Palmyra apps
                get additional love (Transactions, users,
                tenants and more features are activated)</p>
            </div>

          </div>
        </div>
        <div id="content" class="mt-3">
          <div id="sideNav">
            <button class="btn btn-{{theme}} showCharts" type="button" (click)="showCharts = !showCharts"
              data-bs-toggle="collapse" data-bs-target="#charts" aria-expanded="true" aria-controls="charts">
              {{showCharts ? 'Hide charts' : 'Show sharts'}}
            </button>
            <button class="btn btn-{{theme}} showFilter" type="button" (click)="showFilter = !showFilter"
              data-bs-toggle="collapse" data-bs-target="#filter" aria-expanded="true" aria-controls="filter">
              {{showFilter ? 'Hide filter' : 'Show filter'}}
            </button>
            <button class="btn btn-{{theme}} collapseAll" type="button" (click)="collapseAll()">
              Collapse All
            </button>
            <button class="btn btn-{{theme}} expandAll" type="button" (click)="expandAll()">
              Expand All
            </button>
          </div>


          <div class="row collapse show" id="charts">
            <div class="col-6 ">
              <app-line-chart #line [lineData]="lineData"></app-line-chart>
              <app-line-chart #selectionLine [lineData]="selectionLineData"></app-line-chart>
            </div>
            <app-pie-chart pie class="col-6 chart bg-body rounded shadow-lg p-2 my-2" (ex)="updateBubbleChart($event)"
              [exceptions]="exceptions">
            </app-pie-chart>
          </div>

          <div *ngIf="currentTransactionalSearch" class="alert alert-warning alert-dismissible fade show my-3"
            role="alert">
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"
              (click)="restUsingObject(); currentTransactionalSearch = null"></button>
            <h4>Transaction : <b>{{currentTransactionalSearch}}</b></h4>
            <div class="d-flex">
              <svg class="bi flex-shrink-0 me-1" width="30" height="30" role="img" aria-label="Warning:">
                <use xlink:href="#exclamation-triangle-fill" />
              </svg>
              <p> You are using Advisor's Experimental Transaction Boundaries features. </p>
            </div>
            <span class="badge bg-light text-dark">Closing this warning will reset your search.</span>
          </div>


          <div class="p-2 mt-3 ">
            <div class="row fw-bold shadow-lg border border-2 bg-body rounded">
              <div (click)="sortByName()" class="col-6 ">Exception</div>
              <div (click)="sortByCount()" class="col-1">Count</div>
              <div (click)="sortByFirstOccurence()" class="col-2">First occurence</div>
              <div (click)="sortByLastOccurence()" class="col-2">Last occurence</div>
            </div>
          </div>
          <div *ngFor="let exception of exceptions; let e = index" class="shadow-lg p-2 mb-2 bg-body rounded">
            <a class="text-decoration-none text-dark" data-bs-toggle="collapse" href="#exception{{e}}" role="button"
              aria-expanded="true" [attr.aria-controls]="'exception' +e">
              <div class="row p-2">
                <div class="col-6 fw-bold text-truncate">{{exception.exception.name}}</div>
                <div class="col-1">{{exception.count}}</div>
                <div class="col-2">{{exception.firstOccurence}}</div>
                <div class="col-2">{{exception.lastOccurence}}</div>
              </div>
            </a>
            <div class="collapse mb-2 exception" id="exception{{e}}">
              <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                <symbol id="check-circle-fill" fill="currentColor" viewBox="0 0 16 16">
                  <path
                    d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                </symbol>
                <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
                  <path
                    d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z" />
                </symbol>
                <symbol id="exclamation-triangle-fill" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                </symbol>
              </svg>
              <div class="alert alert-danger mb-1 mx-5  mt-2" role="alert">
                <div class="d-flex align-items-center">
                  <svg class="bi flex-shrink-0 me-2" width="30" height="30" role="img" aria-label="Danger:">
                    <use xlink:href="#exclamation-triangle-fill" />
                  </svg>
                  <h5 class="alert-heading">Message:</h5>
                </div>
                <p class="mb-0">{{exception.message}}</p>
              </div>

              <div *ngIf="!exception.hint.includes('No idea!')" class="mx-5">
                <div class="alert alert-primary d-flex align-items-center mb-1 fw-bold" role="alert">
                  <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:">
                    <use xlink:href="#info-fill" />
                  </svg>
                  <div>
                    <p class="my-1" *ngFor="let item of exception.hint.split('/n')">{{item}}</p>
                  </div>
                </div>
                <div class="alert alert-success d-flex align-items-center fw-bold" role="alert">
                  <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Success:">
                    <use xlink:href="#check-circle-fill" />
                  </svg>
                  <div>
                    <p class="my-1" *ngFor="let item of exception.todo.split('/n')">{{item}}</p>
                  </div>
                </div>
              </div>
              <div class="">
                <div class="d-grid gap-2 mx-5">
                  <button class="btn btn-outline-dark" type="button" data-bs-toggle="collapse"
                    [attr.data-bs-target]="'#cb'+e" aria-expanded="false"
                    [attr.aria-controls]="'cb'+e">stacktrace</button>
                </div>
                <div class="collapse p-3 mx-5 mt-1 caused-by overflow-scroll" id="cb{{e}}" style="max-height: 60vh;">
                  <div class="p-2 text-wrap rounded shadow-lg">
                    <div *ngFor="let cb of exception.exception.causedBy">
                      <p> {{cb}}</p>
                    </div>
                  </div>
                  <div>
                    <p class="text-wrap text-truncate"> {{exception.exception.stackTrace}}</p>
                  </div>
                </div>
              </div>

              <div class="mt-3 mx-2 bg-body rounded shadow-lg border border-2 rounded">
                <div class="row fw-bold">
                  <div class="col-2 d-flex justify-content-center">File</div>
                  <div class="col-2 d-flex justify-content-center">Date</div>
                  <div class="d-flex justify-content-center"
                    [ngClass]="exception.exception.framework=='Palmyra' ? 'col-2' : 'col-4'">Logger</div>
                  <div class="d-flex justify-content-center"
                    [ngClass]="exception.exception.framework=='Palmyra' ? 'col-2' : 'col-3'">Thread</div>
                  <div class="col-1 d-flex justify-content-center">Level</div>
                  <div *ngIf="exception.exception.framework=='Palmyra'" class="col-1 d-flex justify-content-center">User
                  </div>
                  <div *ngIf="exception.exception.framework=='Palmyra'" class="col-1 d-flex justify-content-center">
                    Tenant</div>
                  <div *ngIf="exception.exception.framework=='Palmyra'" class="col-1 mx-0 px-0">Transaction</div>
                  <div></div>
                </div>
              </div>

              <div id="editor" class="mt-1 mx-2 bg-body rounded shadow border border-1 rounded">
                <div *ngFor="let occurence of occurences(exception)" class="p-1 border-bottom">
                  <a class="text-decoration-none text-dark">
                    <div class="row ">
                      <div class="col-2 d-flex justify-content-center py-0">
                        <p placement="top" tooltip="{{'File : ' +occurence.logFile}}" class="text-truncate my-0 ">
                          {{exception.logFile}}</p>
                      </div>
                      <div class="col-2 d-flex justify-content-center py-0">
                        <p placement="top" tooltip="{{'Date : ' +occurence.date}}" class="text-truncate my-0 ">
                          {{occurence.date}}</p>
                      </div>
                      <div class="d-flex justify-content-center py-0"
                        [ngClass]="occurence.framework=='Palmyra' ? 'col-2' : 'col-4'">
                        <p placement="top" tooltip="{{'Logger : ' +occurence.logger}}" class="text-truncate my-0 ">
                          {{occurence.logger}}</p>
                      </div>
                      <div class="d-flex justify-content-center py-0"
                        [ngClass]="occurence.framework=='Palmyra' ? 'col-2' : 'col-3'">
                        <p placement="top" tooltip="{{'Thread : ' +occurence.thread}}" class="text-truncate my-0 ">
                          {{occurence.thread}}</p>
                      </div>
                      <div class="col-1 d-flex justify-content-center py-0">
                        <div level-color [level]='occurence.level' class="rounded px-2 fw-bold" placement="top"
                          tooltip="{{'Level : ' +occurence.level}}">
                          <p class="text-truncate my-0 "> {{occurence.level}}</p>
                        </div>
                      </div>
                      <div *ngIf="occurence.framework=='Palmyra'" class="col-1 d-flex justify-content-center py-0">
                        <p placement="top" tooltip="{{'User : ' +occurence.user}}" class="my-0 ">{{occurence.user}}</p>
                      </div>
                      <div *ngIf="occurence.framework=='Palmyra'" class="col-1 d-flex justify-content-center py-0">
                        <p placement="top" tooltip="{{'Tenant : ' +occurence.tenant}}" class="my-0 ">
                          {{occurence.tenant}}</p>
                      </div>
                      <div *ngIf="occurence.framework=='Palmyra'"
                        class="col-1 d-flex justify-content-center py-0 mx-0 px-0">
                        <svg width="64" height="30" viewBox="0 0 1040 1024" version="1.1" style="margin: 0;"
                          placement="top" tooltip="{{'Transaction : ' +occurence.transaction}}"
                          [ngStyle]="{'cursor' : occurence.transaction != null? 'pointer' : 'none' }"
                          (click)="transactionalSearch(occurence.transaction)" xmlns="http://www.w3.org/2000/svg">
                          <path
                            d="M174.107004 756.14277C204.0436 746.051721 233.701274 734.997906 264.023319 726.254403 281.066052 721.354604 297.998191 725.759921 313.373894 735.567705 344.665258 755.511567 376.973101 773.556909 411.949006 786.254635 441.967733 797.159452 470.45198 794.430792 497.123637 776.355977 500.476399 774.079228 503.353448 771.05175 507.059945 767.843342 491.980242 759.422401 477.651921 751.727629 463.636675 743.477792 446.762271 733.552117 429.887055 723.600244 413.50788 712.899278 383.559086 693.288618 371.924847 659.459946 383.441988 627.301381 394.167899 597.312317 426.557875 575.642679 455.112868 580.303423 464.600299 581.8802 474.038938 585.175387 482.927865 589.060024 505.748278 599.020082 528.20601 609.773444 550.834512 620.184596 572.736027 630.265002 590.127616 627.015661 607.333798 609.737422 651.326299 565.534436 695.279766 521.300343 739.31943 477.118645 752.615819 463.765157 753.417621 443.985851 740.993779 431.166141 728.367454 418.146674 708.720089 418.822903 694.844711 432.653682 680.636742 446.845498 666.464552 461.091347 651.961396 474.977797 649.07215 477.792418 645.946266 483.945615 640.880936 479.279959 639.809972 478.258247 642.489416 471.222511 645.046883 468.419351 658.346526 453.679021 672.10643 439.373407 685.815918 425.012123 702.230871 407.835401 698.80899 382.139494 678.725756 372.362818 665.970135 366.137577 651.728012 369.520361 640.611771 380.72809 623.145368 398.259302 605.481363 415.641513 587.780762 432.922208 585.50303 435.158024 582.364951 436.571065 578.779616 438.935413 577.233753 430.962289 581.59893 427.213555 584.963077 423.514758 598.060235 409.223062 611.430625 395.1958 624.789628 381.153803 630.804759 374.867977 634.936553 367.869084 635.174003 358.877521 635.504969 345.312815 628.446523 333.860302 616.434965 328.678876 604.209541 323.404939 590.803371 326.446335 581.268776 336.355637 566.154105 351.93839 550.906883 367.431908 535.664542 382.909052 533.207911 385.382283 530.626861 387.852241 527.697769 389.672985 526.082784 390.689786 523.672502 390.34676 521.61921 390.61938 521.642792 388.496543 521.020706 386.021672 521.858286 384.300809 523.165075 381.627 525.32652 379.30113 527.401768 377.0997 539.249062 364.556705 551.475301 352.306797 563.097342 339.502644 573.306067 328.309651 573.882615 311.842725 565.28237 300.035723 554.636964 285.437023 533.939777 282.763214 520.276641 294.701204 514.163928 300.073382 508.724533 306.262602 503.285138 312.357674 502.175954 313.602067 502.031207 316.171084 502.210921 318.019664 505.477485 352.378842 488.179413 381.184914 456.81649 394.075029 454.289925 395.082005 451.727577 398.01861 450.807866 400.670314 443.456673 421.76524 429.912262 436.770005 409.331361 445.489765 406.808047 446.571241 404.281481 449.460363 403.269065 452.058852 395.738158 471.730093 382.594647 485.595256 363.240029 493.746034 360.670364 494.827509 357.882767 497.570088 356.963867 500.175127 343.686995 537.438982 306.485402 553.666855 269.075636 544.698215 242.81057 538.414847 224.589533 522.316326 214.185642 497.225422 213.923796 496.589309 213.582259 495.979392 213.215512 495.373569 212.965864 494.992883 212.624327 494.65968 211.965646 493.950703 199.480003 498.307718 186.782931 502.736776 174.109442 507.196126 174.107004 590.180796 174.107004 673.167105 174.107004 756.14277L174.107004 756.14277 174.107004 756.14277ZM889.439903 514.239228C864.483252 509.670176 839.665658 504.537053 814.614678 500.816972 797.043375 498.179184 781.834374 504.229229 769.005565 517.044845 720.90892 565.075158 672.552869 612.83285 624.455411 660.844333 609.812387 675.456952 592.619214 678.928973 574.552682 670.498208 546.979202 657.603181 520.14572 643.013485 493.015426 629.093471 484.73395 624.855984 476.565506 620.367981 468.260447 616.158328 448.104027 605.955121 424.376912 613.599134 413.778671 633.629776 403.429264 653.154474 410.414524 677.382487 429.791913 688.388821 486.478232 720.614518 543.214156 752.740336 599.933815 784.899721 600.136298 785.020066 600.334716 785.119126 600.537198 785.256665 624.785566 801.193907 647.501077 798.117308 669.024459 779.764961 693.167112 759.158787 717.41629 738.665592 741.50202 717.988193 753.322479 707.824282 766.680671 704.547925 781.729472 707.848843 815.579928 715.268539 849.402737 722.751274 883.232861 730.159509 885.238176 730.599958 887.348391 730.617969 889.43909 730.839013 889.439903 658.629805 889.439903 586.422237 889.439903 514.239228L889.439903 514.239228 889.439903 514.239228ZM386.758157 334.429285C379.663117 332.539772 373.706536 330.533187 367.629603 329.430426 357.820966 327.59822 348.017206 327.303494 339.80241 334.464488 330.706935 342.41387 327.32002 352.251127 331.096452 364.120349 332.914734 369.79462 334.838729 375.473803 337.04246 382.173061 329.785596 380.309745 323.613521 378.516017 317.360941 377.234783 294.89589 372.576495 277.689706 392.083182 284.912418 413.918192 286.597336 419.025936 288.4514 424.025614 290.694163 430.453889 286.278568 429.337211 282.763982 428.731387 279.457571 427.554945 247.620562 416.315288 231.634156 442.961682 236.980035 466.496274 242.264111 489.791811 261.473983 509.978002 283.495848 513.149568 309.076212 516.841814 329.917333 495.64701 325.83433 470.08291 325.549715 468.256436 325.245583 466.425867 324.782882 463.550662 338.966456 465.547423 352.134361 464.429106 362.581351 453.949185 373.222691 443.273599 373.790295 429.977419 371.396277 415.380356 386.510947 416.793397 400.444874 415.746306 410.747116 403.475932 420.862325 391.405314 421.212809 377.599915 416.917564 362.797365 422.478125 363.332781 427.271037 364.318471 432.036302 364.185027 457.430446 363.511253 473.829949 340.381909 467.105721 314.993007 459.952946 288.003586 422.00729 268.496899 396.200861 278.5683 381.176454 284.426774 374.074908 298.786419 378.937755 314.378179 380.952828 320.805633 383.818492 326.960468 386.758157 334.429285L386.758157 334.429285 386.758157 334.429285Z" />
                        </svg>
                      </div>
                    </div>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <app-correlation *ngIf="correlationView" [correlations]="correlationIds"
        (transSearch)="transactionalSearch($event)"></app-correlation>
    </main>
  </div>
</div>
<div *ngIf="this.downloading == 'excel'" style="display: none;">
  <table id="excel-table">
    <div *ngFor="let exception of exceptions">
      <tr>
        <td>{{exception.exception.name}}</td>
        <td>{{exception.message}}</td>
        <td *ngIf="!exception.hint.includes('No idea!')">{{exception.hint}}</td>
        <td *ngIf="!exception.hint.includes('No idea!')">{{exception.todo}}</td>
      </tr>
      <tr *ngFor="let occurence of occurences(exception); let o = index">
        <td></td>
        <td>{{o+1}}</td>
        <td>{{occurence.date|date:'dd/MM/yyyy HH:mm:ss.SSS'}}</td>
        <td>{{occurence.logger}}</td>
        <td>{{occurence.thread}}</td>
        <td>{{occurence.level}}</td>
      </tr>
    </div>
  </table>
</div>
